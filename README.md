# Результаты инференса RAFT-Stereo
## Почему выбрана модель RAFT-Stereo
Причины выбора:

1. **Революционная архитектура**: RAFT-Stereo использует 3D корреляционный объем вместо традиционного 4D, реализуя его через одно матричное умножение, что кардинально снижает вычислительные затраты по сравнению с методами на основе 3D-сверток.
2. **Превосходная точность**: Первое место на Middlebury с bad 2px ошибкой 4.74% (на 26% лучше следующего метода) и первое место на ETH3D с bad 1-pixel ошибкой 2.44%, что подтверждает выдающееся качество восстановления глубины.
3. **Хорошая генерализация**: При обучении только на синтетических данных SceneFlow показывает state-of-the-art результаты на реальных датасетах KITTI, ETH3D и Middlebury, что критично для работы с разнообразными сценами Instereo2k.
4. **Масштабируемость**: Способность напрямую работать с мегапиксельными изображениями без изменения размера или обработки по частям, используя только 2D-свертки вместо затратных 3D-операций.
5. **Гибкость производительности**: Модифицированная версия работает в реальном времени со скоростью 26 FPS при сохранении конкурентоспособной точности.

## Преимущества:

**Рекордная точность на ведущих бенчмарках стереозрения**

**Эффективная архитектура без затратных 3D-сверток**

**Хорошая кроссдатасетная генерализация**

**Поддержка высоких разрешений без компромиссов**

**Баланс точность/скорость с возможностью real-time инференса**

**Веса Middlebury для оптимальной работы с challenging сценами**


## Структура репозитория
- `disparity_instereo2k_sample/` - сгенерированные disparity maps
  - `.png` файлы - визуализация

## Использование
Для воспроизведения результатов:

1. **Клонируйте этот репозиторий с подмодулями:**
   ```bash
   git clone --recurse-submodules https://github.com/Tim-cmd-stack/Robot_vision.git```

2. **Создайте conda окружение:**

Для CUDA 11.3
   ```bash
   conda env create -f environment_cuda11.yaml
   conda activate raftstereo
```

Или для CUDA 10.2:
```bash
conda env create -f environment.yaml
conda activate raftstereo
```

3. **Поместите данные датасета в нужную папку:**
4. **Для задачи 1 запустите инференс-скрипт:**
   ```bash
   python task_1_inference.py --mode all
5. **Для задачи 2 запустите скрипт:**
   ```bash
   python task_2_training.py
   
